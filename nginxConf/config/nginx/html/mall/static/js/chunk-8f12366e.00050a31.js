(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8f12366e"],{"57e7":function(e,o,s){},8644:function(e,o,s){"use strict";s.r(o);var t=s("f8b7"),i=s("8194"),r=s("ff66"),a=s("e487"),n={data(){return{order:{},orderGoods:{},form:{complainTopic:"",content:""},visible:!1,action:r.c+"/common/upload/file",accessToken:{},previewImage:"",loading:!1,reasonList:[]}},methods:{getOrderDetail(){Object(t.i)(this.$route.query.sn).then(e=>{this.order=e.result,this.orderGoods=e.result.orderItems[this.$route.query.index],this.orderGoods.uploadList=[]}),Object(i.f)("COMPLAIN").then(e=>{e.success&&(this.reasonList=e.result,this.$set(this.form,"complainTopic",e.result[0].reason),this.$forceUpdate())})},save(){var e={goodsId:this.orderGoods.goodsId,complainTopic:this.form.complainTopic,content:this.form.content,images:this.orderGoods.uploadList.toString(),orderSn:this.$route.query.sn,skuId:this.orderGoods.skuId};Object(i.G)(e).then(e=>{e.success&&(this.$Message.success("投诉申请已提交，感谢您的反馈"),this.$router.push({name:"ComplainList"}))})},goGoodsDetail(e,o){o=this.$router.resolve({path:"/goodsDetail",query:{skuId:e,goodsId:o}});window.open(o.href,"_blank")},handleView(e){this.previewImage=e,this.visible=!0},handleRemove(e){this.orderGoods.uploadList.splice(e,1),this.$forceUpdate()},handleSuccess(e,o){this.orderGoods.uploadList.push(e.result),this.$forceUpdate()},handleBeforeUpload(){var e=this.orderGoods.uploadList.length<6;if(!e)return this.$Notice.warning({title:"最多可以上传五张图片"}),e}},mounted(){this.accessToken.accessToken=a.a.getItem("accessToken"),this.getOrderDetail(),window.scrollTo(0,0)}},s=(s("c9cc"),s("2877")),n=Object(s.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"add-eval"},[i("div",{staticClass:"title"},[i("card",{attrs:{_Title:"商品投诉",_Size:16}}),i("p",[i("span",{staticClass:"color999"},[t._v("订单号：")]),i("span",[t._v(t._s(t.$route.query.sn))]),t.order.order?i("span",{staticClass:"color999 ml_20"},[t._v(t._s(t.order.order.paymentTime))]):t._e()])],1),i("div",{staticClass:"goods-eval"},[i("div",{staticClass:"goods-con"},[i("img",{staticClass:"hover-pointer",attrs:{src:t.orderGoods.image,alt:"",width:"100"},on:{click:function(e){return t.goGoodsDetail(t.orderGoods.skuId,t.orderGoods.goodsId)}}}),i("p",{staticClass:"hover-pointer color999",on:{click:function(e){return t.goGoodsDetail(t.orderGoods.skuId,t.orderGoods.goodsId)}}},[t._v(t._s(t.orderGoods.goodsName))]),i("p",[t._v(t._s(t._f("unitPrice")(t.orderGoods.goodsPrice,"￥")))])]),i("div",{staticClass:"eval-con"},[i("div",[i("span",{staticClass:"color999"},[t._v("投诉主题：")]),i("Select",{staticStyle:{width:"260px","margin-bottom":"10px"},model:{value:t.form.complainTopic,callback:function(e){t.$set(t.form,"complainTopic",e)},expression:"form.complainTopic"}},t._l(t.reasonList,function(e){return i("Option",{key:e.id,attrs:{value:e.reason}},[t._v(t._s(e.reason))])}),1),i("Input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:4,placeholder:"请输入投诉内容"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("div",{staticStyle:{display:"flex","align-items":"center"}},[t._l(t.orderGoods.uploadList,function(o,s){return i("div",{key:s,staticClass:"demo-upload-list"},[i("img",{attrs:{src:o}}),i("div",{staticClass:"demo-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(e){return t.handleView(o)}}}),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(e){return t.handleRemove(s)}}})],1)])}),i("Upload",{staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"on-success":t.handleSuccess,"before-upload":t.handleBeforeUpload,format:["jpg","jpeg","png"],action:t.action,headers:t.accessToken}},[i("div",{staticClass:"hover-pointer icon-upload"},[i("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),i("div",{staticClass:"describe"},[t._v("上传投诉凭证，最多5张")])],2)])]),i("Button",{staticClass:"mt_10",attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t._v("提交")]),i("Modal",{attrs:{title:"View Image"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:t.previewImage}}):t._e()])],1)},[],!1,null,"7a87d988",null);o.default=n.exports},c9cc:function(e,o,s){"use strict";s("57e7")}}]);