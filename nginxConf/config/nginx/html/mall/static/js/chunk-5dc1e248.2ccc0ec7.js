(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5dc1e248"],{2578:function(t,e,s){"use strict";s("e0ad")},"3b56":function(t,e,s){},"4be0":function(t,e,s){"use strict";s("3b56")},e0ad:function(t,e,s){},f896:function(t,e,s){"use strict";s.r(e);var a=s("c40e"),i={name:"GoodsClassNav",data(){return{tabBar:{name:"",first:{},second:{}},showTagCount:5,multiple:!1,tagsContent:[{key:"品牌",more:!1,show:!0,values:[]}],multSelected:[],selectedItem:[],brandIds:[],params:{}}},computed:{cateList(){return this.$store.state.category||[]}},watch:{selectedItem:{handler(t){let s=[];this.params.brandId="",this.params.prop="",t.forEach(e=>{if("品牌"===e.type)this.params.brandId=this.brandIds.join("@");else{const t=e.name.split("、");t.forEach(t=>{s.push(e.type+"_"+t)})}}),this.params.prop=s.join("@"),this.getFilterList(this.params),this.$emit("getParams",this.params)},deep:!0},$route:{handler(t,e){var s;this.$route.query.categoryId?(s=this.$route.query.categoryId.split(","),Object.assign(this.params,this.$route.query),this.params.categoryId=s[s.length-1]):Object.assign(this.params,this.$route.query),this.getFilterList(this.params),this.getNav()},deep:!0}},methods:{getNav(){if(this.$route.query.categoryId)if(this.cateList.length){const e=this.$route.query.categoryId.split(",");var t;0<e.length&&(this.tabBar=this.cateList.filter(t=>t.id===e[0])[0]),1<e.length&&(t=this.tabBar.children.filter(t=>t.id===e[1])[0],this.$set(this.tabBar,"first",t)),2<e.length&&(t=this.tabBar.first.children.filter(t=>t.id===e[2])[0],this.$set(this.tabBar,"second",t))}else setTimeout(()=>{this.getNav()},500)},cateClick(t,e){switch(e){case 1:this.$router.push({path:"/goodsList",query:{categoryId:t.id}});break;case 2:this.$router.push({path:"/goodsList",query:{categoryId:[t.parentId,t.id].toString()}});break;case 3:this.$router.push({path:"/goodsList",query:{categoryId:[this.tabBar.id,t.parentId,t.id].toString()}})}},selectBrand(e,t){if(!1!==this.multiple){var s=this.multSelected.indexOf(e);-1<s?this.multSelected.splice(s,1):this.multSelected.push(e)}else if(this.selectedItem.push({type:this.tagsContent[t].key,name:e}),this.tagsContent[t].show=!1,0===t){let t=this.tagsContent[0].values;t.forEach(t=>{t.name===e&&this.brandIds.push(t.value)})}},cancelSelected(s,t){this.selectedItem.splice(t,1),this.tagsContent.forEach((t,e)=>{t.key===s.type&&(t.show=!0,t.more=!1)}),"品牌"===s.type&&(this.brandIds=[])},moreBrand(t){var e=!this.tagsContent[t].more;this.$set(this.tagsContent[t],"more",e)},multSelectBrand(t){this.$set(this.tagsContent[t],"more",!0),this.multiple=t},sure(t){if(this.selectedItem.push({type:this.tagsContent[t].key,name:this.multSelected.join("、")}),0===t){let t=this.tagsContent[0].values;t.forEach(t=>{this.multSelected.includes(t.name)&&this.brandIds.push(t.value)})}this.tagsContent[t].show=!1,this.cancel()},cancel(){this.multSelected=[],this.tagsContent[0].more=!1,this.multiple=!1},getFilterList(t){a.a(t).then(t=>{t.success&&(t=t.result,this.tagsContent=[{key:"品牌",more:!1,show:!0,values:[]}],this.tagsContent[0].values=t.brands,this.tagsContent=this.tagsContent.concat(t.paramOptions),this.tagsContent.forEach(t=>{this.$set(t,"show",!0),this.$set(t,"more",!1)}))})},moreOptions(){this.showTagCount=5===this.showTagCount?100:5}},mounted(){var t;this.$route.query.categoryId?(t=this.$route.query.categoryId.split(","),Object.assign(this.params,this.$route.query),this.params.categoryId=t[t.length-1]):Object.assign(this.params,this.$route.query),this.getFilterList(this.params),this.getNav()}},o=(s("2578"),s("2877")),i={name:"GoodsList",beforeRouteEnter(t,e,s){window.scrollTo(0,0),s()},data(){return{sortIndex:0,sortPriceIndex:!1,goodsTool:[{title:"综合",en:""},{title:"销量",en:"buyCount"},{title:"评论数",en:"commentNum"},{title:"新品",en:"releaseTime"}],goodsList:[],loading:!1,total:0,params:{pageNumber:0,pageSize:20,categoryId:""}}},watch:{$route(){var t=this.$route.query.keyword;this.handleSearch(t)}},methods:{handleSearch(t){this.params.keyword=t,this.params.pageNumber=0,this.getGoodsList()},orderBy(t,e){this.sortIndex=e,this.params.sort=t,this.params.order="desc","price"===t?(!this.sortPriceIndex||"desc"===this.sortPriceIndex?this.sortPriceIndex="asc":this.sortPriceIndex="desc",this.params.order=this.sortPriceIndex):this.sortPriceIndex=!1,this.getGoodsList()},goGoodsDetail(t,e){e=this.$router.resolve({path:"/goodsDetail",query:{skuId:t,goodsId:e}});window.open(e.href,"_blank")},changePageNum(t){this.params.pageNumber=t,this.getGoodsList()},changePageSize(t){this.params.pageNumber=1,this.params.pageSize=t,this.getGoodsList()},getGoodsList(){this.loading=!0,a.c(this.params).then(t=>{this.loading=!1,t.success&&(this.goodsList=t.result.content,this.total=t.result.totalElements)}).catch(()=>{this.loading=!1})},getParams(t){Object.assign(this.params,t),this.getGoodsList()}},created(){var t;this.$route.query.categoryId?(t=this.$route.query.categoryId.split(","),Object.assign(this.params,this.$route.query),this.params.categoryId=t[t.length-1]):Object.assign(this.params,this.$route.query),this.getGoodsList()},components:{GoodsClassNav:Object(o.a)(i,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"item-class-show"},[i("div",{staticClass:"head-bar"},[a.$route.query.categoryId?[i("div",{on:{click:function(t){return a.cateClick(a.tabBar,1)}}},[a._v(a._s(a.tabBar.name))]),i("Icon",{attrs:{type:"ios-arrow-forward"}}),a.tabBar.first?i("div",{staticClass:"bar"},[a._v(" "+a._s(a.tabBar.first.name)+" "),i("Icon",{attrs:{type:"ios-arrow-down"}}),i("ul",a._l(a.tabBar.children,function(e){return i("li",{key:e.id,on:{click:function(t){return a.cateClick(e,2)}}},[a._v(" "+a._s(e.name)+" ")])}),0)],1):a._e(),a.tabBar.first?i("Icon",{attrs:{type:"ios-arrow-forward"}}):a._e(),a.tabBar.second?i("div",{staticClass:"bar"},[a._v(" "+a._s(a.tabBar.second.name)+" "),i("Icon",{attrs:{type:"ios-arrow-down"}}),i("ul",a._l(a.tabBar.first.children,function(e){return i("li",{key:e.id,on:{click:function(t){return a.cateClick(e,3)}}},[a._v(" "+a._s(e.name)+" ")])}),0)],1):a._e(),a.tabBar.second?i("Icon",{attrs:{type:"ios-arrow-forward"}}):a._e()]:[i("div",{staticStyle:{"font-size":"14px"}},[a._v("全部结果")]),i("Icon",{attrs:{type:"ios-arrow-forward"}}),i("div",{staticClass:"mr_10",staticStyle:{"font-weight":"bold"}},[a._v("“"+a._s(a.params.keyword)+"”")])],a._l(a.selectedItem,function(e,s){return i("a",{key:s,staticClass:"selected-item",attrs:{title:e.name},on:{click:function(t){return a.cancelSelected(e,s)}}},[i("span",[a._v(a._s(e.type)+"：")]),i("span",[a._v(a._s(e.name))]),i("Icon",{attrs:{type:"md-close"}})],1)})],2),i("div",{staticClass:"content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:a.tagsContent[0].show&&a.tagsContent[0].values.length,expression:"tagsContent[0].show && tagsContent[0].values.length"}],staticClass:"brand"},[i("div",[i("strong",[a._v(a._s(a.tagsContent[0].key)+"：")])]),i("div",[i("ul",{class:{"show-more":a.tagsContent[0].more}},a._l(a.tagsContent[0].values,function(e,t){return i("li",{key:t,class:{"border-color":a.multSelected.includes(e)},on:{click:function(t){return a.selectBrand(e.name,0)}}},[i("img",{attrs:{src:e.url,alt:""}}),i("span",[a._v(a._s(e.name))]),i("div",{directives:[{name:"show",rawName:"v-show",value:a.multSelected.includes(e.name),expression:"multSelected.includes(item.name)"}],staticClass:"corner-icon"},[i("div"),i("Icon",{attrs:{type:"md-checkmark"}})],1)])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:0!==a.multiple,expression:"multiple !== 0"}],staticClass:"btn"},[i("span",{on:{click:function(t){return a.moreBrand(0)}}},[a._v(a._s(a.tagsContent[0].more?"收起":"更多")),i("Icon",{attrs:{type:a.tagsContent[0].more?"ios-arrow-up":"ios-arrow-down"}})],1),i("span",{on:{click:function(t){return a.multSelectBrand(0)}}},[i("Icon",{attrs:{type:"md-add"}}),a._v("多选")],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:0===a.multiple,expression:"multiple === 0"}],staticClass:"multBtn"},[i("Button",{attrs:{type:"primary",size:"small",disabled:!a.multSelected.length},on:{click:function(t){return a.sure(0)}}},[a._v("确定")]),i("Button",{attrs:{size:"small"},on:{click:a.cancel}},[a._v("取消")])],1)])]),a._l(a.tagsContent,function(t,s){return[t.show&&0!==s?i("div",{directives:[{name:"show",rawName:"v-show",value:s<a.showTagCount,expression:"tagIndex < showTagCount"}],key:s,staticClass:"other"},[i("div",[i("strong",[a._v(a._s(t.key)+"：")])]),i("div",[i("ul",{directives:[{name:"show",rawName:"v-show",value:a.multiple!==s,expression:"multiple !== tagIndex"}],staticClass:"list",class:{"show-more":t.more}},a._l(t.values,function(e,t){return i("li",{key:t,staticClass:"item",on:{click:function(t){return a.selectBrand(e,s)}}},[a._v(" "+a._s(e)+" ")])}),0),i("CheckboxGroup",{directives:[{name:"show",rawName:"v-show",value:a.multiple===s,expression:"multiple === tagIndex"}],staticClass:"list",class:{"show-more":t.more},model:{value:a.multSelected,callback:function(t){a.multSelected=t},expression:"multSelected"}},a._l(t.values,function(t,e){return i("Checkbox",{key:e,staticClass:"item",attrs:{label:t}},[a._v(a._s(t))])}),1),i("div",{directives:[{name:"show",rawName:"v-show",value:a.multiple!==s,expression:"multiple !== tagIndex"}],staticClass:"btn"},[i("span",{directives:[{name:"show",rawName:"v-show",value:9<t.values.length,expression:"tag.values.length > 9"}],on:{click:function(t){return a.moreBrand(s)}}},[a._v(a._s(t.more?"收起":"更多")),i("Icon",{attrs:{type:t.more?"ios-arrow-up":"ios-arrow-down"}})],1),i("span",{on:{click:function(t){return a.multSelectBrand(s)}}},[i("Icon",{attrs:{type:"md-add"}}),a._v("多选")],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:a.multiple===s,expression:"multiple === tagIndex"}],staticClass:"multBtn"},[i("Button",{attrs:{type:"primary",size:"small",disabled:!a.multSelected.length},on:{click:function(t){return a.sure(s)}}},[a._v("确定")]),i("Button",{attrs:{size:"small"},on:{click:a.cancel}},[a._v("取消")])],1)],1)]):a._e()]}),4<a.tagsContent.length?i("div",{staticClass:"more-options",on:{click:a.moreOptions}},[a._v(a._s(5===a.showTagCount?"更多筛选项":"收起筛选项")),i("Icon",{attrs:{type:5===a.showTagCount?"ios-arrow-down":"ios-arrow-up"}})],1):a._e()],2)])},[],!1,null,"69f4269c",null).exports}},i=(s("4be0"),Object(o.a)(i,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",[i("BaseHeader"),i("Search",{on:{search:a.handleSearch}}),i("drawer"),i("cateNav"),i("div",{staticClass:"container"},[i("GoodsClassNav",{on:{getParams:a.getParams}}),i("div",{staticClass:"goods-box"},[i("div",{staticClass:"goods-list-box"},[i("div",{staticClass:"goods-list-tool"},[i("ul",[a._l(a.goodsTool,function(e,s){return i("li",{key:s,on:{click:function(t){return a.orderBy(e.en,s)}}},[i("span",{class:{"goods-list-tool-active":s===a.sortIndex}},[a._v(a._s(e.title)),i("Icon",{attrs:{type:"ios-arrow-round-down"}})],1)])}),i("li",{staticClass:"price-sort",on:{click:function(t){return a.orderBy("price",5,"up")}}},[i("span",{class:{"goods-list-tool-active":5===a.sortIndex}},[a._v(" 价格 "),i("div",[i("Icon",{class:{"price-color":"desc"==a.sortPriceIndex},attrs:{type:"md-arrow-dropup"}}),i("Icon",{class:{"price-color":"asc"==a.sortPriceIndex},attrs:{type:"md-arrow-dropdown"}})],1)])])],2)]),i("div",{staticClass:"goods-list"},[0===a.goodsList.length?i("empty"):a._l(a.goodsList,function(e,t){return i("div",{key:t,staticClass:"goods-show-info",on:{click:function(t){return a.goGoodsDetail(e.id,e.content.goodsId)}}},[i("div",{staticClass:"goods-show-img"},[i("img",{attrs:{width:"220",height:"220",src:e.content.thumbnail}})]),i("div",{staticClass:"goods-show-price"},[i("span",[i("span",{staticClass:"seckill-price text-danger"},[a._v(a._s(a._f("unitPrice")(e.content.price,"￥")))])])]),i("div",{staticClass:"goods-show-detail"},[i("span",[a._v(a._s(e.content.goodsName))])]),i("div",{staticClass:"goods-show-num"},[a._v(" 已有"),i("span",[a._v(a._s(e.content.commentNum||0))]),a._v("人评价 ")]),i("div",{staticClass:"goods-show-seller"},[e.content.selfOperated?i("Tag",{staticStyle:{padding:"0 4px"},attrs:{size:"default",color:"error"}},[a._v("自营")]):a._e(),i("span",[a._v(a._s(e.content.storeName))])],1)])})],2)])]),i("div",{staticClass:"goods-page"},[i("Page",{attrs:{"show-total":"","show-sizer":"",total:a.total,"page-size":a.params.pageSize},on:{"on-change":a.changePageNum,"on-page-size-change":a.changePageSize}})],1)],1),a.loading?i("Spin",{attrs:{size:"large",fix:""}}):a._e(),i("BaseFooter")],1)},[],!1,null,"329d4204",null));e.default=i.exports}}]);